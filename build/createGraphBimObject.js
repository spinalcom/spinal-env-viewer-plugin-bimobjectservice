"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _spinalEnvViewerGraphService = require("spinal-env-viewer-graph-service");

var _spinalModelsBimobject = require("spinal-models-bimobject");

var _spinalModelsBimobject2 = _interopRequireDefault(_spinalModelsBimobject);

var _spinalServiceAssemblyManager = require("spinal-service-assembly-manager");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step("next", value); }, function (err) { step("throw", err); }); } } return step("next"); }); }; }

const BIM_OBJECT_CONTEXT_TYPE = "BIMObjectContext";
const BIM_OBJECT_NODE_TYPE = "BIMObject";
const BIM_OBJECT_RELATION_NAME = "hasBIMObject";
const REFERENCE_OBJECT_RELATION_NAME = "hasReferenceObject";
const BIM_OBJECT_RELATION_TYPE = _spinalEnvViewerGraphService.SPINAL_RELATION_PTR_LST_TYPE;

const assemblyManger = _spinalServiceAssemblyManager.assemblyManagerService;
const bimObjectService = {
  createBIMObject(dbid, name) {
    return assemblyManger.createBimObj(dbid, name, assemblyManger._getCurrentModel());
  },

  getBIMObject(dbid) {
    console.log('getBimObject', assemblyManger);
    return assemblyManger.getBimObjectFromViewer(dbid, assemblyManger._getCurrentModel()).then(bimObj => {
      if (bimObj) {
        console.log('bimObj', bimObj);
        return _spinalEnvViewerGraphService.SpinalGraphService.getRealNode(bimObj.id);
      }
      return undefined;
    });
  },

  addBIMObject(context, parent, dbId, name) {
    console.log('add to parent');
    return this.getBIMObject(dbId).then(bimObject => {
      console.log('then get bim object', bimObject);
      if (bimObject) {
        return _spinalEnvViewerGraphService.SpinalGraphService.addChildInContext(parent.info.id.get(), bimObject.info.id.get(), context.info.id.get(), BIM_OBJECT_RELATION_NAME, BIM_OBJECT_RELATION_TYPE);
      }
      return assemblyManger.createBimObj(dbId, name, assemblyManger._getCurrentModel()).then(bimObj => {
        console.log('create then', bimObj);
        return this.addBIMObject(context, parent, dbId, name);
      });
    }).catch(e => {
      console.error(e);
    });
  },

  removeBIMObject(parent, child) {
    _spinalEnvViewerGraphService.SpinalGraphService.removeChild(parent.info.id.get(), child.info.id.get(), BIM_OBJECT_RELATION_NAME, BIM_OBJECT_RELATION_TYPE);
  },

  deleteBIMObject(dbId) {
    return this.getBIMObject(dbId).then(BIMobj => {
      if (BIMobj) return _spinalEnvViewerGraphService.SpinalGraphService.removeFromGraph(BIMobj.info.id.get());
      // @ts-ignore
      throw Error("The dbId has no BIM object");
    });
  },

  addReferenceObject(parent, dbId, name) {
    var _this = this;

    return _asyncToGenerator(function* () {

      let node;

      if (dbId instanceof _spinalEnvViewerGraphService.SpinalNode) {
        node = dbId;
      } else {
        node = yield _this.getBIMObject(dbId);

        if (node === undefined) {

          node = yield _this.createBIMObject(dbId, name);
        }
      }

      _spinalEnvViewerGraphService.SpinalGraphService.addChild(parent.info.id.get(), node.info.id.get(), REFERENCE_OBJECT_RELATION_NAME, BIM_OBJECT_RELATION_TYPE);
      return node;
    })();
  },

  removeReferenceObject(parent, child) {
    return this.removeBIMObject(parent, child);
  }
};

bimObjectService.constants = {
  BIM_OBJECT_CONTEXT_TYPE,
  BIM_OBJECT_NODE_TYPE,
  BIM_OBJECT_RELATION_NAME,
  REFERENCE_OBJECT_RELATION_NAME,
  BIM_OBJECT_RELATION_TYPE
};

exports.default = bimObjectService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2NyZWF0ZUdyYXBoQmltT2JqZWN0LmpzIl0sIm5hbWVzIjpbIkJJTV9PQkpFQ1RfQ09OVEVYVF9UWVBFIiwiQklNX09CSkVDVF9OT0RFX1RZUEUiLCJCSU1fT0JKRUNUX1JFTEFUSU9OX05BTUUiLCJSRUZFUkVOQ0VfT0JKRUNUX1JFTEFUSU9OX05BTUUiLCJCSU1fT0JKRUNUX1JFTEFUSU9OX1RZUEUiLCJTUElOQUxfUkVMQVRJT05fUFRSX0xTVF9UWVBFIiwiYXNzZW1ibHlNYW5nZXIiLCJhc3NlbWJseU1hbmFnZXJTZXJ2aWNlIiwiYmltT2JqZWN0U2VydmljZSIsImNyZWF0ZUJJTU9iamVjdCIsImRiaWQiLCJuYW1lIiwiY3JlYXRlQmltT2JqIiwiX2dldEN1cnJlbnRNb2RlbCIsImdldEJJTU9iamVjdCIsImNvbnNvbGUiLCJsb2ciLCJnZXRCaW1PYmplY3RGcm9tVmlld2VyIiwidGhlbiIsImJpbU9iaiIsIlNwaW5hbEdyYXBoU2VydmljZSIsImdldFJlYWxOb2RlIiwiaWQiLCJ1bmRlZmluZWQiLCJhZGRCSU1PYmplY3QiLCJjb250ZXh0IiwicGFyZW50IiwiZGJJZCIsImJpbU9iamVjdCIsImFkZENoaWxkSW5Db250ZXh0IiwiaW5mbyIsImdldCIsImNhdGNoIiwiZSIsImVycm9yIiwicmVtb3ZlQklNT2JqZWN0IiwiY2hpbGQiLCJyZW1vdmVDaGlsZCIsImRlbGV0ZUJJTU9iamVjdCIsIkJJTW9iaiIsInJlbW92ZUZyb21HcmFwaCIsIkVycm9yIiwiYWRkUmVmZXJlbmNlT2JqZWN0Iiwibm9kZSIsIlNwaW5hbE5vZGUiLCJhZGRDaGlsZCIsInJlbW92ZVJlZmVyZW5jZU9iamVjdCIsImNvbnN0YW50cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0FBS0E7Ozs7QUFDQTs7Ozs7O0FBRUEsTUFBTUEsMEJBQTBCLGtCQUFoQztBQUNBLE1BQU1DLHVCQUF1QixXQUE3QjtBQUNBLE1BQU1DLDJCQUEyQixjQUFqQztBQUNBLE1BQU1DLGlDQUFp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RUEsVUFBSWhCLGdCQUFnQmlCLHVDQUFwQixFQUFnQztBQUM5QkQsZUFBT2hCLElBQVA7QUFDRCxPQUZELE1BRU87QUFDTGdCLGVBQU8sTUFBTSxNQUFLN0IsWUFBTCxDQUFrQmEsSUFBbEIsQ0FBYjs7QUFFQSxZQUFJZ0IsU0FBU3BCLFNBQWIsRUFBd0I7O0FBRXRCb0IsaUJBQU8sTUFBTSxNQUFLbEMsZUFBTCxDQUFxQmtCLElBQXJCLEVBQTJCaEIsSUFBM0IsQ0FBYjtBQUNEO0FBQ0Y7O0FBRURTLHNEQUNHeUIsUUFESCxDQUNZbkIsT0FBT0ksSUFBUCxDQUFZUixFQUFaLENBQWVTLEdBQWYsRUFEWixFQUNrQ1ksS0FBS2IsSUFBTCxDQUFVUixFQUFWLENBQWFTLEdBQWIsRUFEbEMsRUFFSTVCLDhCQUZKLEVBR0lDLHdCQUhKO0FBSUEsYUFBT3VDLElBQVA7QUFuQjJDO0FBb0I1QyxHQS9Fc0I7O0FBaUZ2Qkcsd0JBQXNCcEIsTUFBdEIsRUFBOEJVLEtBQTlCLEVBQXFDO0FBQ25DLFdBQU8sS0FBS0QsZUFBTCxDQUFxQlQsTUFBckIsRUFBNkJVLEtBQTdCLENBQVA7QUFDRDtBQW5Gc0IsQ0FBekI7O0FBc0ZBNUIsaUJBQWlCdUMsU0FBakIsR0FBNkI7QUFDM0IvQyx5QkFEMkI7QUFFM0JDLHNCQUYyQjtBQUczQkMsMEJBSDJCO0FBSTNCQyxnQ0FKMkI7QUFLM0JDO0FBTDJCLENBQTdCOztrQkFRZUksZ0IiLCJmaWxlIjoiY3JlYXRlR3JhcGhCaW1PYmplY3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBTcGluYWxOb2RlLFxuICBTUElOQUxfUkVMQVRJT05fUFRSX0xTVF9UWVBFLFxuICBTcGluYWxHcmFwaFNlcnZpY2Vcbn0gZnJvbSBcInNwaW5hbC1lbnYtdmlld2VyLWdyYXBoLXNlcnZpY2VcIjtcbmltcG9ydCBTcGluYWxCSU1PYmplY3QgZnJvbSBcInNwaW5hbC1tb2RlbHMtYmltb2JqZWN0XCI7XG5pbXBvcnQgeyBhc3NlbWJseU1hbmFnZXJTZXJ2aWNlIH0gZnJvbSBcInNwaW5hbC1zZXJ2aWNlLWFzc2VtYmx5LW1hbmFnZXJcIjtcblxuY29uc3QgQklNX09CSkVDVF9DT05URVhUX1RZUEUgPSBcIkJJTU9iamVjdENvbnRleHRcIjtcbmNvbnN0IEJJTV9PQkpFQ1RfTk9ERV9UWVBFID0gXCJCSU1PYmplY3RcIjtcbmNvbnN0IEJJTV9PQkpFQ1RfUkVMQVRJT05fTkFNRSA9IFwiaGFzQklNT2JqZWN0XCI7XG5jb25zdCBSRUZFUkVOQ0VfT0JKRUNUX1JFTEFUSU9OX05BTUUgPSBcImhhc1JlZmVyZW5jZU9iamVjdFwiO1xuY29uc3QgQklNX09CSkVDVF9SRUxBVElPTl9UWVBFID0gU1BJTkFMX1JFTEFUSU9OX1BUUl9MU1RfVFlQRTtcblxuY29uc3QgYXNzZW1ibHlNYW5nZXIgPSAgYXNzZW1ibHlNYW5hZ2VyU2VydmljZTtcbmNvbnN0IGJpbU9iamVjdFNlcnZpY2UgPSB7XG4gIGNyZWF0ZUJJTU9iamVjdChkYmlkLCBuYW1lKSB7XG4gICAgcmV0dXJuIGFzc2VtYmx5TWFuZ2VyLmNyZWF0ZUJpbU9iaihkYmlkLCBuYW1lLCBhc3NlbWJseU1hbmdlci5fZ2V0Q3VycmVudE1vZGVsKCkpXG4gIH0sXG4gIFxuICBnZXRCSU1PYmplY3QoZGJpZCkge1xuICAgIGNvbnNvbGUubG9nKCdnZXRCaW1PYmplY3QnLCBhc3NlbWJseU1hbmdlcik7XG4gICAgcmV0dXJuIGFzc2VtYmx5TWFuZ2VyLmdldEJpbU9iamVjdEZyb21WaWV3ZXIoZGJpZCwgYXNzZW1ibHlNYW5nZXIuX2dldEN1cnJlbnRNb2RlbCgpKVxuICAgICAgLnRoZW4oYmltT2JqID0+IHtcbiAgICAgICAgaWYgKGJpbU9iaikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCAnYmltT2JqJywgYmltT2JqKTtcbiAgICAgICAgICByZXR1cm4gU3BpbmFsR3JhcGhTZXJ2aWNlLmdldFJlYWxOb2RlKGJpbU9iai5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH0pO1xuICB9LFxuICBcbiAgYWRkQklNT2JqZWN0KGNvbnRleHQsIHBhcmVudCwgZGJJZCwgbmFtZSkge1xuICAgIGNvbnNvbGUubG9nKCdhZGQgdG8gcGFyZW50JylcbiAgICByZXR1cm4gdGhpcy5nZXRCSU1PYmplY3QoZGJJZClcbiAgICAgIC50aGVuKGJpbU9iamVjdCA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGVuIGdldCBiaW0gb2JqZWN0JyxiaW1PYmplY3QpO1xuICAgICAgICBpZiAoYmltT2JqZWN0KSB7XG4gICAgICAgICAgcmV0dXJuIFNwaW5hbEdyYXBoU2VydmljZS5hZGRDaGlsZEluQ29udGV4dChcbiAgICAgICAgICAgIHBhcmVudC5pbmZvLmlkLmdldCgpLCBiaW1PYmplY3QuaW5mby5pZC5nZXQoKSwgY29udGV4dC5pbmZvLmlkLmdldCgpXG4gICAgICAgICAgICAsIEJJTV9PQkpFQ1RfUkVMQVRJT05fTkFNRSwgQklNX09CSkVDVF9SRUxBVElPTl9UWVBFLFxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNzZW1ibHlNYW5nZXIuY3JlYXRlQmltT2JqKGRiSWQsIG5hbWUsIGFzc2VtYmx5TWFuZ2VyLl9nZXRDdXJyZW50TW9kZWwoKSlcbiAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgIChiaW1PYmopID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0ZSB0aGVuJyxiaW1PYmopO1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRCSU1PYmplY3QoY29udGV4dCwgcGFyZW50LCBkYklkLCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICB9KS5jYXRjaChlID0+IHtjb25zb2xlLmVycm9yKGUpfSlcbiAgfSxcbiAgXG4gIHJlbW92ZUJJTU9iamVjdChwYXJlbnQsIGNoaWxkKSB7XG4gICAgU3BpbmFsR3JhcGhTZXJ2aWNlLnJlbW92ZUNoaWxkKFxuICAgICAgcGFyZW50LmluZm8uaWQuZ2V0KCksXG4gICAgICBjaGlsZC5pbmZvLmlkLmdldCgpLFxuICAgICAgQklNX09CSkVDVF9SRUxBVElPTl9OQU1FLFxuICAgICAgQklNX09CSkVDVF9SRUxBVElPTl9UWVBFXG4gICAgKTtcbiAgfSxcbiAgXG4gIGRlbGV0ZUJJTU9iamVjdChkYklkKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QklNT2JqZWN0KGRiSWQpLnRoZW4oXG4gICAgICAoQklNb2JqKSA9PiB7XG4gICAgICAgIGlmIChCSU1vYmopXG4gICAgICAgICAgcmV0dXJuIFNwaW5hbEdyYXBoU2VydmljZS5yZW1vdmVGcm9tR3JhcGgoQklNb2JqLmluZm8uaWQuZ2V0KCkpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRocm93IEVycm9yKFwiVGhlIGRiSWQgaGFzIG5vIEJJTSBvYmplY3RcIik7XG4gICAgICB9XG4gICAgKVxuICAgIFxuICB9LFxuICBcbiAgYXN5bmMgYWRkUmVmZXJlbmNlT2JqZWN0KHBhcmVudCwgZGJJZCwgbmFtZSkge1xuICAgIFxuICAgIGxldCBub2RlO1xuICAgIFxuICAgIGlmIChkYklkIGluc3RhbmNlb2YgU3BpbmFsTm9kZSkge1xuICAgICAgbm9kZSA9IGRiSWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUgPSBhd2FpdCB0aGlzLmdldEJJTU9iamVjdChkYklkKTtcbiAgICAgIFxuICAgICAgaWYgKG5vZGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBcbiAgICAgICAgbm9kZSA9IGF3YWl0IHRoaXMuY3JlYXRlQklNT2JqZWN0KGRiSWQsIG5hbWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBTcGluYWxHcmFwaFNlcnZpY2VcbiAgICAgIC5hZGRDaGlsZChwYXJlbnQuaW5mby5pZC5nZXQoKSwgbm9kZS5pbmZvLmlkLmdldCgpLFxuICAgICAgICBSRUZFUkVOQ0VfT0JKRUNUX1JFTEFUSU9OX05BTUUsXG4gICAgICAgIEJJTV9PQkpFQ1RfUkVMQVRJT05fVFlQRSk7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH0sXG4gIFxuICByZW1vdmVSZWZlcmVuY2VPYmplY3QocGFyZW50LCBjaGlsZCkge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZUJJTU9iamVjdChwYXJlbnQsIGNoaWxkKVxuICB9LFxufTtcblxuYmltT2JqZWN0U2VydmljZS5jb25zdGFudHMgPSB7XG4gIEJJTV9PQkpFQ1RfQ09OVEVYVF9UWVBFLFxuICBCSU1fT0JKRUNUX05PREVfVFlQRSxcbiAgQklNX09CSkVDVF9SRUxBVElPTl9OQU1FLFxuICBSRUZFUkVOQ0VfT0JKRUNUX1JFTEFUSU9OX05BTUUsXG4gIEJJTV9PQkpFQ1RfUkVMQVRJT05fVFlQRVxufTtcblxuZXhwb3J0IGRlZmF1bHQgYmltT2JqZWN0U2VydmljZTtcbiJdfQ==